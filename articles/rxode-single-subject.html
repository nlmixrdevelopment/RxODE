<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Single Subject ODE solving -- differences from multiple subject • RxODE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Single Subject ODE solving -- differences from multiple subject">
<meta property="og:description" content="RxODE">
<meta property="og:image" content="https://nlmixrdevelopment.github.io/RxODE/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RxODE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/RxODE-intro.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/RxODE-syntax.html">RxODE mini language syntax</a>
    </li>
    <li>
      <a href="../articles/RxODE-pipeline.html">RxODE with piping ie %&gt;%</a>
    </li>
    <li>
      <a href="../articles/RxODE-speed.html">Speeding up RxODE ODE solving</a>
    </li>
    <li>
      <a href="../articles/RxODE-data-frame.html">Adaptive Data Frames with RxODE</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced Features, Model Types, Technical Details</li>
    <li>
      <a href="../articles/RxODE-model-types.html">RxODE model types</a>
    </li>
    <li>
      <a href="../articles/RxODE-cmt.html">Chainging RxODE compartment numbers</a>
    </li>
    <li>
      <a href="../articles/RxODE-transit-compartments.html">RxODE transit compartment models</a>
    </li>
    <li>
      <a href="../articles/RxODE-shiny.html">Using Shiny with RxODE</a>
    </li>
    <li>
      <a href="../articles/RxODE-covariates.html">RxODE covariates</a>
    </li>
    <li>
      <a href="../articles/RxODE-stiff.html">Stiff Systems and Jacobian specification</a>
    </li>
    <li>
      <a href="../articles/RxODE-rxUse.html">Adding compiled RxODE models to your package</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-stethoscope"></span>
     
    Dosing/Events
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/RxODE-dataset.html">nlmixr/RxODE dataset overview</a>
    </li>
    <li>
      <a href="../articles/RxODE-event-types.html">Supported Event Types</a>
    </li>
    <li>
      <a href="../articles/RxODE-event-table.html">Easy RxODE Event Tables</a>
    </li>
    <li>
      <a href="../articles/RxODE-events-classic.html">Classic RxODE events explained</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Simulations
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rxode-single-subject.html">Single Subject ODE solving</a>
    </li>
    <li>
      <a href="../articles/RxODE-sim-var.html">Multiple Subject RxODE Simulation</a>
    </li>
    <li>
      <a href="../articles/RxODE-prior-data.html">Using Prior Data for ODE solving</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-life-ring"></span>
     
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/RxODE-tutorials.html">Running the interactive tutorials</a>
    </li>
    <li>
      <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/RxODE-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a>
    </li>
    <li>
      <a href="../articles/RxODE-wt.html">Weight Based Dosing</a>
    </li>
    <li>
      <a href="../articles/RxODE-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://nlmixrdevelopment.github.io/RxODE/reference/index.html">
    <span class="fas fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-archive"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://nlmixrdevelopment.github.io/RxODE-manual/">RxODE User Guide</a>
    </li>
    <li>
      <a href="https://nlmixrdevelopment.github.io/nlmixr/">nlmixr</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/nlmixrdevelopment/RxODE">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/nlmixrdevelopment/RxODE/releases">
    <span class="fas fa-download"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="rxode-single-subject_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Single Subject ODE solving – differences from multiple subject</h1>
            
            <h4 class="date">2021-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixrdevelopment/RxODE/blob/master/vignettes/rxode-single-subject.Rmd"><code>vignettes/rxode-single-subject.Rmd</code></a></small>
      <div class="hidden name"><code>rxode-single-subject.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixrdevelopment.github.io/RxODE/">RxODE</a></span><span class="op">)</span>
<span class="co">#&gt; RxODE 1.0.3 using 1 threads (see ?getRxThreads)</span>
<span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></code></pre></div>
<div id="single-subject-solving" class="section level1">
<h1 class="hasAnchor">
<a href="#single-subject-solving" class="anchor"></a>Single Subject solving</h1>
<p>Originally, RxODE was only created to solve ODEs for one individual. That is a single system without any changes in individual parameters.</p>
<p>Of course this is still supported, the classic examples are found in <a href="https://nlmixrdevelopment.github.io/RxODE/articles/RxODE-intro.html">RxODE intro</a>.</p>
<p>This article discusses the differences between multiple subject and single subject solving. There are three differences:</p>
<ul>
<li>Single solving does not solve each ID in parallel</li>
<li>Single solving lacks the <code>id</code> column in parameters(<code>$params</code>) as well as in the actual dataset.</li>
<li>Single solving allows parameter exploration easier because each parameter can be modified. With multiple subject solves, you have to make sure to update each individual parameter.</li>
</ul>
<p>The first obvious difference is in speed; With multiple subjects you can run each subject ID in parallel. For more information and examples of the speed gains with multiple subject solving see the <a href="RxODE-speed.html">Speeding up RxODE</a> vignette.</p>
<p>The next difference is the amount of information output in the final data.</p>
<p>Taking the 2 compartment indirect response model originally in the tutorial:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod1</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/RxODE.html">RxODE</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">KA</span><span class="op">=</span><span class="fl">2.94E-01</span>;
    <span class="va">CL</span><span class="op">=</span><span class="fl">1.86E+01</span>;
    <span class="va">V2</span><span class="op">=</span><span class="fl">4.02E+01</span>;
    <span class="va">Q</span><span class="op">=</span><span class="fl">1.05E+01</span>;
    <span class="va">V3</span><span class="op">=</span><span class="fl">2.97E+02</span>;
    <span class="va">Kin</span><span class="op">=</span><span class="fl">1</span>;
    <span class="va">Kout</span><span class="op">=</span><span class="fl">1</span>;
    <span class="va">EC50</span><span class="op">=</span><span class="fl">200</span>;
    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span>;
    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span>;
    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span><span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span>;
    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span>;
    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span>  <span class="op">=</span>                    <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span>;
    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span>  <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span>;
    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span>
<span class="op">}</span><span class="op">)</span>;
<span class="co">#&gt; qs v0.23.6.</span>

<span class="va">et</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">'mg'</span>, time.units<span class="op">=</span><span class="st">'hours'</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>dose<span class="op">=</span><span class="fl">10000</span>, addl<span class="op">=</span><span class="fl">9</span>, ii<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">20000</span>, nbr.doses<span class="op">=</span><span class="fl">5</span>, start.time<span class="op">=</span><span class="fl">120</span>, dosing.interval<span class="op">=</span><span class="fl">24</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span> <span class="co"># sampling</span></code></pre></div>
<p>Now a simple solve</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">et</span><span class="op">)</span>
<span class="va">x</span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂ Solved RxODE object ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span>
<span class="co">#&gt; ── Parameters (x$params): ──────────────────────────────────────────────────────</span>
<span class="co">#&gt;      KA      CL      V2       Q      V3     Kin    Kout    EC50 </span>
<span class="co">#&gt;   0.294  18.600  40.200  10.500 297.000   1.000   1.000 200.000 </span>
<span class="co">#&gt; ── Initial Conditions (x$inits): ───────────────────────────────────────────────</span>
<span class="co">#&gt; depot centr  peri   eff </span>
<span class="co">#&gt;     0     0     0     1 </span>
<span class="co">#&gt; ── First part of data (object): ────────────────────────────────────────────────</span>
<span class="co">#&gt; # A tibble: 241 x 7</span>
<span class="co">#&gt;    time    C2    C3  depot centr  peri   eff</span>
<span class="co">#&gt;     [h] &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     0   0   0     10000     0     0   1   </span>
<span class="co">#&gt; 2     1  44.4 0.920  7453. 1784.  273.  1.08</span>
<span class="co">#&gt; 3     2  54.9 2.67   5554. 2206.  794.  1.18</span>
<span class="co">#&gt; 4     3  51.9 4.46   4140. 2087. 1324.  1.23</span>
<span class="co">#&gt; 5     4  44.5 5.98   3085. 1789. 1776.  1.23</span>
<span class="co">#&gt; 6     5  36.5 7.18   2299. 1467. 2132.  1.21</span>
<span class="co">#&gt; # … with 235 more rows</span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂ Solved RxODE object ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span>
<span class="co">#&gt; ── Parameters ($params): ───────────────────────────────────────────────────────</span>
<span class="co">#&gt;      KA      CL      V2       Q      V3     Kin    Kout    EC50 </span>
<span class="co">#&gt;   0.294  18.600  40.200  10.500 297.000   1.000   1.000 200.000 </span>
<span class="co">#&gt; ── Initial Conditions ($inits): ────────────────────────────────────────────────</span>
<span class="co">#&gt; depot centr  peri   eff </span>
<span class="co">#&gt;     0     0     0     1 </span>
<span class="co">#&gt; ── First part of data (object): ────────────────────────────────────────────────</span>
<span class="co">#&gt; # A tibble: 241 x 7</span>
<span class="co">#&gt;    time    C2    C3  depot centr  peri   eff</span>
<span class="co">#&gt;     [h] &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     0   0   0     10000     0     0   1   </span>
<span class="co">#&gt; 2     1  44.4 0.920  7453. 1784.  273.  1.08</span>
<span class="co">#&gt; 3     2  54.9 2.67   5554. 2206.  794.  1.18</span>
<span class="co">#&gt; 4     3  51.9 4.46   4140. 2087. 1324.  1.23</span>
<span class="co">#&gt; 5     4  44.5 5.98   3085. 1789. 1776.  1.23</span>
<span class="co">#&gt; 6     5  36.5 7.18   2299. 1467. 2132.  1.21</span>
<span class="co">#&gt; # … with 235 more rows</span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">C2</span>, <span class="va">eff</span><span class="op">)</span></code></pre></div>
<p><img src="rxode-single-subject_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>To better see the differences between the single solve, you can solve for 2 individuals</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">et</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>CL<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.6</span>, <span class="fl">7.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: 'ID' missing in 'parameters' dataset</span>
<span class="co">#&gt; individual parameters are assumed to have the same order as the event dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂ Solved RxODE object ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span>
<span class="co">#&gt; ── Parameters ($params): ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; # A tibble: 2 x 9</span>
<span class="co">#&gt;   id       KA    CL    V2     Q    V3   Kin  Kout  EC50</span>
<span class="co">#&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1     0.294  18.6  40.2  10.5   297     1     1   200</span>
<span class="co">#&gt; 2 2     0.294   7.6  40.2  10.5   297     1     1   200</span>
<span class="co">#&gt; ── Initial Conditions ($inits): ────────────────────────────────────────────────</span>
<span class="co">#&gt; depot centr  peri   eff </span>
<span class="co">#&gt;     0     0     0     1 </span>
<span class="co">#&gt; ── First part of data (object): ────────────────────────────────────────────────</span>
<span class="co">#&gt; # A tibble: 482 x 8</span>
<span class="co">#&gt;      id  time    C2    C3  depot centr  peri   eff</span>
<span class="co">#&gt;   &lt;int&gt;   [h] &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1     0   0   0     10000     0     0   1   </span>
<span class="co">#&gt; 2     1     1  44.4 0.920  7453. 1784.  273.  1.08</span>
<span class="co">#&gt; 3     1     2  54.9 2.67   5554. 2206.  794.  1.18</span>
<span class="co">#&gt; 4     1     3  51.9 4.46   4140. 2087. 1324.  1.23</span>
<span class="co">#&gt; 5     1     4  44.5 5.98   3085. 1789. 1776.  1.23</span>
<span class="co">#&gt; 6     1     5  36.5 7.18   2299. 1467. 2132.  1.21</span>
<span class="co">#&gt; # … with 476 more rows</span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">C2</span>, <span class="va">eff</span><span class="op">)</span></code></pre></div>
<p><img src="rxode-single-subject_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>By observing the two solves, you can see:</p>
<ul>
<li>A multiple subject solve contains the <code>id</code> column both in the data frame and then data frame of parameters for each subject.</li>
</ul>
<p>The last feature that is not as obvious, modifying the individual parameters. For single subject data, you can modify the RxODE data frame changing initial conditions and parameter values as if they were part of the data frame, as described in the <a href="https://nlmixrdevelopment.github.io/RxODE/articles/RxODE-data-frame.html">RxODE Data Frames</a>.</p>
<p>For multiple subject solving, this feature still works, but requires care when supplying each individual’s parameter value, otherwise you may change the solve and drop parameter for key individuals.</p>
<div id="summary-of-single-solve-vs-multiple-subject-solving" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-of-single-solve-vs-multiple-subject-solving" class="anchor"></a>Summary of Single solve vs Multiple subject solving</h2>
<table class="table">
<colgroup>
<col width="10%">
<col width="40%">
<col width="49%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>Single Subject Solve</th>
<th>Multiple Subject Solve</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Parallel</td>
<td>None</td>
<td>Each Subject</td>
</tr>
<tr class="even">
<td>$params</td>
<td>data.frame with one parameter value</td>
<td>data.frame with one parameter per subject (w/ID column)</td>
</tr>
<tr class="odd">
<td>solved data</td>
<td>Can modify individual parameters with $ syntax</td>
<td>Have to modify all the parameters to update solved object</td>
</tr>
</tbody>
</table>
</div>
<div id="session-information" class="section level2">
<h2 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session Information</h2>
<p>The session information:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.0.3 (2020-10-10)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 16.04.7 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /usr/lib/openblas-base/libblas.so.3</span>
<span class="co">#&gt; LAPACK: /usr/lib/libopenblasp-r0.2.18.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] qs_0.23.6   RxODE_1.0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;   [1] bitops_1.0-6        fs_1.5.0            xgxr_1.1.0         </span>
<span class="co">#&gt;   [4] RColorBrewer_1.1-2  rprojroot_2.0.2     Deriv_4.1.2        </span>
<span class="co">#&gt;   [7] tools_4.0.3         backports_1.2.1     utf8_1.1.4         </span>
<span class="co">#&gt;  [10] R6_2.5.0            rpart_4.1-15        Hmisc_4.4-2        </span>
<span class="co">#&gt;  [13] colorspace_2.0-0    nnet_7.3-14         lotri_0.3.1        </span>
<span class="co">#&gt;  [16] tidyselect_1.1.0    gridExtra_2.3       Exact_2.1          </span>
<span class="co">#&gt;  [19] compiler_4.0.3      textshaping_0.3.0   cli_2.3.0          </span>
<span class="co">#&gt;  [22] htmlTable_2.1.0     binom_1.1-1         expm_0.999-6       </span>
<span class="co">#&gt;  [25] desc_1.2.0          labeling_0.4.2      stringfish_0.14.2  </span>
<span class="co">#&gt;  [28] scales_1.1.1        checkmate_2.0.0     mvtnorm_1.1-1      </span>
<span class="co">#&gt;  [31] readr_1.4.0         pkgdown_1.6.1.9000  systemfonts_1.0.1  </span>
<span class="co">#&gt;  [34] stringr_1.4.0       digest_0.6.27       foreign_0.8-80     </span>
<span class="co">#&gt;  [37] rmarkdown_2.6       PreciseSums_0.4     base64enc_0.1-3    </span>
<span class="co">#&gt;  [40] jpeg_0.1-8.1        pkgconfig_2.0.3     htmltools_0.5.1.1  </span>
<span class="co">#&gt;  [43] highr_0.8           fastmap_1.1.0       htmlwidgets_1.5.3  </span>
<span class="co">#&gt;  [46] rlang_0.4.10        rstudioapi_0.13     farver_2.0.3       </span>
<span class="co">#&gt;  [49] generics_0.1.0      RApiSerialize_0.1.0 dplyr_1.0.4        </span>
<span class="co">#&gt;  [52] RCurl_1.98-1.2      magrittr_2.0.1      Formula_1.2-4      </span>
<span class="co">#&gt;  [55] Matrix_1.2-18       Rcpp_1.0.6          DescTools_0.99.40  </span>
<span class="co">#&gt;  [58] munsell_0.5.0       fansi_0.4.2         lifecycle_0.2.0    </span>
<span class="co">#&gt;  [61] stringi_1.5.3       yaml_2.2.1          MASS_7.3-53        </span>
<span class="co">#&gt;  [64] rootSolve_1.8.2.1   grid_4.0.3          ggrepel_0.9.1      </span>
<span class="co">#&gt;  [67] crayon_1.4.1        lmom_2.8            lattice_0.20-41    </span>
<span class="co">#&gt;  [70] splines_4.0.3       pander_0.6.3        hms_1.0.0          </span>
<span class="co">#&gt;  [73] sys_3.4             knitr_1.31          ps_1.5.0           </span>
<span class="co">#&gt;  [76] pillar_1.4.7        boot_1.3-25         gld_2.6.2          </span>
<span class="co">#&gt;  [79] glue_1.4.2          evaluate_0.14       dparser_0.1.8      </span>
<span class="co">#&gt;  [82] latticeExtra_0.6-29 data.table_1.13.6   RcppParallel_5.0.2 </span>
<span class="co">#&gt;  [85] vctrs_0.3.6         png_0.1-7           gtable_0.3.0       </span>
<span class="co">#&gt;  [88] purrr_0.3.4         assertthat_0.2.1    cachem_1.0.3       </span>
<span class="co">#&gt;  [91] ggplot2_3.3.3       xfun_0.21           e1071_1.7-4        </span>
<span class="co">#&gt;  [94] ragg_0.4.1          class_7.3-17        survival_3.2-7     </span>
<span class="co">#&gt;  [97] minpack.lm_1.2-1    tibble_3.0.6        memoise_2.0.0      </span>
<span class="co">#&gt; [100] units_0.6-7         cluster_2.1.0       ellipsis_0.3.1</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew L. Fidler, Melissa Hallow, Wenping Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '038b4d83946a52a95a9f8bdafe822dbe',
    indexName: 'rxode',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
